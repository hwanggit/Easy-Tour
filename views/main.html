<!--MAP RENDER>-->
<!DOCTYPE html>
<html>

<head>
  <meta charset='utf-8' />
  <title>Play map locations as a slideshow</title>
  <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
  <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.1/mapbox-gl.js'></script>
  <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.1/mapbox-gl.css' rel='stylesheet' />
  <style>
    body {
      margin: 0;
      padding: 0;
    }

    #map {
      position: absolute;
      top: 0;
      bottom: 0;
      width: 100%;
    }
  </style>
</head>

<body>

  <style>
    .map-overlay-container {
      position: absolute;
      width: 25%;
      top: 0;
      left: 0;
      padding: 10px;
      z-index: 1;
    }

    .map-overlay {
      font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
      background-color: #fff;
      border-radius: 3px;
      padding: 10px;
      box-shadow: 0 1px 2px rgba(0, 0, 0, 0.20);
    }

    .map-overlay h2,
    .map-overlay p {
      margin: 0 0 10px;
    }
  </style>

  <div id='map'></div>

  <div class='map-overlay-container'>
    <div class='map-overlay'>
      <h2 id='location-title'></h2>
      <p id='location-description'></p>
      <small>Text credit: <a target='_blank' href='http://www.nycgo.com/neighborhoods'>nycgo.com</a></small>
    </div>
  </div>

  <script>
    mapboxgl.accessToken = 'pk.eyJ1IjoiaG93YXJkb3ciLCJhIjoiY2p0dGNrdDk3MWE3bDQzbzR6M3ZuZTdsdCJ9.5cRHWydUp1I-w2piGEY0xQ';
    var map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/mapbox/streets-v11',
      center: [-74.0315, 40.6989],
      maxZoom: 16,
      minZoom: 9,
      zoom: 9.68
    });

    var title = document.getElementById('location-title');
    var description = document.getElementById('location-description');

    var locations = [
    {
        "id": "2",
        "title": "LA Basin",
        "description": "Los Angeles is in a large basin bounded by the Pacific Ocean on one side and by mountains as high as 10,000 feet (3,000 m) on the others. The city proper, which covers about 469 square miles (1,210 km2), is the seat of Los Angeles County, the most populated county in the country.",
        "camera": { center: [
                -118.8709,
                34.8255
            ], zoom: 12.21, pitch: 50
        }
    },
    {
        "id": "3",
        "title": "Sunset Hills",
        "description": "Sunset Hills Neighborhood is nestled in a hilly and wooded area on the near west side. Our homes were built in the mid-fifties and sixties and were designed to respect the topography using a variety of natural materials.",
        "camera": { center: [
                -118.349050,
                34.101579
            ], bearing: -8.9, zoom: 11.68
        }
    },
    {
        "id": "4",
        "title": "Santa Monica Beach",
        "description": "North Beach is characterized by an abundance of sand and sweeping views of Santa Monica Bay. South Beach is alive with sites such as the Santa Monica Pier. It is here that the modern beach culture — surfing, beach volleyball, rollerblading, lifeguards, skateboarding, and spectacular sunsets — got its start.",
        "camera": { center: [
                -118.4999,
                34.0125
            ], zoom: 9.68, bearing: 0, pitch: 0
        }
    }
];

    function highlightBorough(code) {
      // Only show the polygon feature that cooresponds to `borocode` in the data
      map.setFilter('highlight', ["==", "borocode", code]);
    }

    function playback(index) {
      title.textContent = locations[index].title;
      description.textContent = locations[index].description;

      highlightBorough(locations[index].id ? locations[index].id : '');

      // Animate the map position based on camera properties
      map.flyTo(locations[index].camera);

      map.once('moveend', function () {
        // Duration the slide is on screen after interaction
        window.setTimeout(function () {
          // Increment index
          index = (index + 1 === locations.length) ? 0 : index + 1;
          playback(index);
        }, 3000); // After callback, show the location for 3 seconds.
      });
    }

    // Display the last title/description first
    title.textContent = locations[locations.length - 1].title;
    description.textContent = locations[locations.length - 1].description;

    map.on('load', function () {

      map.addLayer({
        "id": "highlight",
        "type": "fill",
        "source": {
          "type": "vector",
          "url": "mapbox://mapbox.8ibmsn6u"
        },
        "source-layer": "original",
        "paint": {
          "fill-color": "#fd6b50",
          "fill-opacity": 0.25
        },
        "filter": ["==", "borocode", ""]
      }, 'settlement-subdivision-label'); // Place polygon under the neighborhood labels.

      // Start the playback animation for each borough
      playback(0);
    });
  </script>

</body>

</html>